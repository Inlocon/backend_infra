{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "S3State",
      "Effect": "Allow",
      "Action": ["s3:ListBucket"],
      "Resource": ["arn:aws:s3:::backend-inlocon-terraform"]
    },
    {
      "Sid": "S3StateObjects",
      "Effect": "Allow",
      "Action": ["s3:GetObject","s3:PutObject","s3:DeleteObject"],
      "Resource": ["arn:aws:s3:::backend-inlocon-terraform/*"]
    },
    {
      "Sid": "S3AllowCreateBucket",
      "Effect": "Allow",
      "Action": ["s3:CreateBucket"],
      "Resource": "*"
    },
    {
      "Sid": "S3AllowEverythingOnBackendBuckets",
      "Effect": "Allow",
      "Action": "s3:*",
      "Resource": ["arn:aws:s3:::test-backend-inlocon*",
                   "arn:aws:s3:::test-backend-inlocon*/*",
                   "arn:aws:s3:::prod-backend-inlocon*",
                   "arn:aws:s3:::prod-backend-inlocon*/*"]
    },
    {
      "Sid": "Reads",
      "Effect": "Allow",
      "Action": [
        "ec2:Describe*",
        "rds:Describe*","rds:ListTagsForResource",
        "secretsmanager:Describe*","secretsmanager:ListSecrets","secretsmanager:GetSecretValue","secretsmanager:ListSecretVersionIds"
      ],
      "Resource": "*"
    },
    {
      "Sid": "Ec2NetworkingCrud",
      "Effect": "Allow",
      "Action": [
        "ec2:CreateVpc","ec2:DeleteVpc","ec2:DescribeVpcAttribute","ec2:ModifyVpcAttribute",
        "ec2:CreateSubnet","ec2:DeleteSubnet","ec2:ModifySubnetAttribute",
        "ec2:CreateInternetGateway","ec2:DeleteInternetGateway","ec2:AttachInternetGateway","ec2:DetachInternetGateway",
        "ec2:CreateRouteTable","ec2:DeleteRouteTable","ec2:AssociateRouteTable","ec2:DisassociateRouteTable","ec2:ReplaceRouteTableAssociation",
        "ec2:CreateRoute","ec2:ReplaceRoute","ec2:DeleteRoute",
        "ec2:CreateTags","ec2:DeleteTags"
      ],
      "Resource": "*"
    },
    {
      "Sid": "Ec2InstanceCrud",
      "Effect": "Allow",
      "Action": [
        "ec2:RunInstances",
        "ec2:TerminateInstances",
        "ec2:StartInstances",
        "ec2:StopInstances",
        "ec2:RebootInstances",
        "ec2:ModifyInstanceAttribute",
        "ec2:CreateImage",
        "ec2:CreateTags",
        "ec2:DeleteTags"
      ],
      "Resource": "*"
    },
    {
      "Sid": "Ec2StorageAndEniCrud",
      "Effect": "Allow",
      "Action": [
        "ec2:CreateVolume",
        "ec2:DeleteVolume",
        "ec2:AttachVolume",
        "ec2:DetachVolume",
        "ec2:ModifyVolume",
        "ec2:CreateNetworkInterface",
        "ec2:DeleteNetworkInterface",
        "ec2:AttachNetworkInterface",
        "ec2:DetachNetworkInterface",
        "ec2:ModifyNetworkInterfaceAttribute"
      ],
      "Resource": "*"
    },
    {
      "Sid": "Ec2Addresses",
      "Effect": "Allow",
      "Action": [
        "ec2:AllocateAddress",
        "ec2:ReleaseAddress",
        "ec2:AssociateAddress",
        "ec2:DisassociateAddress"
      ],
      "Resource": "*"
    },
    {
      "Sid": "Ec2IamInstanceProfileAttach",
      "Effect": "Allow",
      "Action": [
        "ec2:AssociateIamInstanceProfile",
        "ec2:ReplaceIamInstanceProfileAssociation",
        "ec2:DisassociateIamInstanceProfile"
      ],
      "Resource": "*"
    },
    {
      "Sid": "IamPassRoleForEc2",
      "Effect": "Allow",
      "Action": [
        "iam:PassRole",
        "iam:GetRole",
        "iam:ListInstanceProfiles",
        "iam:GetInstanceProfile"
      ],
      "Resource": "arn:aws:iam::864981740157:role/ec2-migration",
      "Condition": {
        "StringEquals": {
          "iam:PassedToService": "ec2.amazonaws.com"
        }
      }
    },
    {
      "Sid": "Ec2SecurityGroupsCrud",
      "Effect": "Allow",
      "Action": [
        "ec2:CreateSecurityGroup","ec2:DeleteSecurityGroup",
        "ec2:AuthorizeSecurityGroupIngress","ec2:AuthorizeSecurityGroupEgress",
        "ec2:RevokeSecurityGroupIngress","ec2:RevokeSecurityGroupEgress",
        "ec2:UpdateSecurityGroupRuleDescriptionsIngress","ec2:UpdateSecurityGroupRuleDescriptionsEgress",
        "ec2:CreateTags","ec2:DeleteTags"
      ],
      "Resource": "*"
    },
    {
      "Sid": "RdsCrud",
      "Effect": "Allow",
      "Action": [
        "rds:CreateDBInstance","rds:ModifyDBInstance","rds:DeleteDBInstance","rds:RebootDBInstance",
        "rds:CreateDBSubnetGroup","rds:ModifyDBSubnetGroup","rds:DeleteDBSubnetGroup",
        "rds:CreateDBParameterGroup","rds:ModifyDBParameterGroup","rds:ResetDBParameterGroup","rds:DeleteDBParameterGroup",
        "rds:AddTagsToResource","rds:RemoveTagsFromResource"
      ],
      "Resource": "*"
    },
    {
      "Sid": "SecretsCrudDb",
      "Effect": "Allow",
      "Action": [
        "secretsmanager:CreateSecret","secretsmanager:UpdateSecret","secretsmanager:PutSecretValue",
        "secretsmanager:TagResource","secretsmanager:UntagResource",
        "secretsmanager:DeleteSecret","secretsmanager:RestoreSecret","secretsmanager:RotateSecret",
        "secretsmanager:GetResourcePolicy"
      ],
      "Resource": ["*"]
    }
  ]
}
